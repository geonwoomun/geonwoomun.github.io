{
    "componentChunkName": "component---src-templates-post-template-tsx",
    "path": "/axios-error-handle/",
    "result": {"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>axios를 timeout을 주고 사용하고 있었다.\n분명 axios에서 에러가 나면 <code class=\"language-text\">error.response</code> 값을 활용해서 에러처리를 하고 있었는데\n빈 error message가 뜬다는 현상이 가끔 CS로 올라왔다.</p>\n<p>한참을 못 찾다가 찾아낸 것이 axios의 timeout 됐을 때의 error였다.\naxios의 config에서 timeout을 60000 으로 설정해두었는데 느린 환경에서 용량이 큰 파일을 업로드할 때 60초 이상이 걸려서 연결이 끊겨서 에러가 나는 것이었다. 글로벌 서비스였기에 느린 환경에서 큰 옹량의 파일을 올릴 때 에러가 나는 것 같았다.\n해당 에러일 때는 axios의 error 객체에 response가 <code class=\"language-text\">undefined</code> 로 내려와서 기존과 같은 방법으로는 처리 하기가 힘들었고, error.code에 <code class=\"language-text\">ECONNABORTED</code> 값이 추가 되기 때문에 아래와 같이 처리하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 550px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7f2044994d9ff3af0138b4fba46410e8/8c3ad/timeout-error.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.479166666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB5UlEQVQoz42Sy27bMBBF/f//5CBZdNEmbusURhxbsmyZoijrScmkKOtxCqvNouiiHeCAcwHiziU4C4DB9YjPIfEmZugs9vUH9XJJ/fSEfnykWa1oXl4YreVftbj1N4qkIN0kyK+CPMgwbYOKBFWeMTQ1/SnAeXta/4ALQ1wQYN/faT2P9t7vdrO22y2LiQmrLfG3CLWWiC8h6l2RHlL0RWPdgPIzmjiHa8N4NYxaMxbFzFTXM6OuGYqcxTiNmMogXwTya0T8PSL3M8RWEAeSsmrY+SlS3c1brOtmGttSG0ttDI21WOfoht9P1oUmWcdEK8Flo2jKmjhVHM8hZyE4HgOCIEBEkrIs0VqjVEJ4PiNlPPeXywVjOhYfnxKvJadPAXIlSLbJPFHGijTNyIsSlVz4n1p0t45UZnPCw4OHWJ1obE+a3JNUf1yexpHpfn4wTX/pOWF37ajCklpqsn1Kra/c8hyz22E2G5wQs75lGc3z87xKZr1maBo6KXHHI/btjXa//2XYux59LKkOBfWl5hbH3MITnefRJwn96YTbbOh8H3c60fo+5vWVarlEPzzMRnfupotxHGmtQ4WK5JxQlCVVmlIKQSEirDFEnke635MFAYO1jM4xXK9098FKzbs6GENfFPwEzffzfD3rgxQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7f2044994d9ff3af0138b4fba46410e8/a59e9/timeout-error.webp 192w,\n/static/7f2044994d9ff3af0138b4fba46410e8/0ca9f/timeout-error.webp 384w,\n/static/7f2044994d9ff3af0138b4fba46410e8/7df4b/timeout-error.webp 550w\"\n              sizes=\"(max-width: 550px) 100vw, 550px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7f2044994d9ff3af0138b4fba46410e8/3b721/timeout-error.png 192w,\n/static/7f2044994d9ff3af0138b4fba46410e8/66595/timeout-error.png 384w,\n/static/7f2044994d9ff3af0138b4fba46410e8/8c3ad/timeout-error.png 550w\"\n            sizes=\"(max-width: 550px) 100vw, 550px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7f2044994d9ff3af0138b4fba46410e8/8c3ad/timeout-error.png\"\n            alt=\"timeout-error\"\n            title=\"timeout-error\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<br />\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span>code <span class=\"token operator\">===</span> <span class=\"token string\">'ECONNABORTED'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// timeout 관련 에러처리</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>timeout이 아닐 때의 code 값은 보통 <code class=\"language-text\">undefined</code> 로 내려왔다. (예외가 있을 수 있다.)</p>\n<br />\n<p>그리고 파일을 업로드 하는 도중에 client의 network가 offline으로 끊겼을 때도 error.response가 <code class=\"language-text\">undefined</code>로 내려오는 것을 확인할 수 있었다. (업로드 도중 개발자 도구의 network를 offline으로 바꾸었을 때)\n해당 경우일 때는 <code class=\"language-text\">window.navigator.online</code> 값을 통해 구분하였다.\nnetwork가 offline일 경우 <code class=\"language-text\">window.navigator.online</code>가 false가 된다.\n그래서 다음과 같이 처리하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d95d7baaf76344458038650d080a7921/39d99/offline-error.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABTElEQVQ4y6WT2W7bMBBF8//fl8Rp3AZJLWujTHEVFzk8BVWjQN/iaACC4GB4eMk7fCgU5kZyOU5IMXM+d/T9gLGWGqWUu8ZD3aSFZnjs0BeLVKZi7gb9B0wuIQ4D05tgVpqU0rfU/QOuYUU3CtNovPE47/cBzcUwPPVMr4LpJJGNZHGJlPPd4A0YzMLw2HM5CtRkWdfrPoXXdEWfFKbTJOMpKe0zJS95M0U8j8iPic8UKXsUVpfHp57+ecCMisV7Stnlcsa0Gj06PtPKnriZEpheBHOnkNLgvcf7hSUEQghY57DWEWIkxrTNNVdras/GlHDOEWP8C7Szpf3R0h7PnH82vP86cTh80DQtSqmtsMJrG+W8knPeDqr5vK5brq5rfgOqdqY7tEipkdYya01IcVOab7345SvXh5x/S8YXgZskaRi4Wku5/ZZ7G/sPTKpInKZib8kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d95d7baaf76344458038650d080a7921/a59e9/offline-error.webp 192w,\n/static/d95d7baaf76344458038650d080a7921/0ca9f/offline-error.webp 384w,\n/static/d95d7baaf76344458038650d080a7921/dc9b9/offline-error.webp 768w,\n/static/d95d7baaf76344458038650d080a7921/e084d/offline-error.webp 1102w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d95d7baaf76344458038650d080a7921/3b721/offline-error.png 192w,\n/static/d95d7baaf76344458038650d080a7921/66595/offline-error.png 384w,\n/static/d95d7baaf76344458038650d080a7921/fe486/offline-error.png 768w,\n/static/d95d7baaf76344458038650d080a7921/39d99/offline-error.png 1102w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d95d7baaf76344458038650d080a7921/fe486/offline-error.png\"\n            alt=\"offline-error\"\n            title=\"offline-error\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<br />\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>error<span class=\"token punctuation\">.</span>response <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>window<span class=\"token punctuation\">.</span>navigator<span class=\"token punctuation\">.</span>online<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// offline 처리</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>","frontmatter":{"title":"File Upload 중 axios timeout 및 client Network offline 에러 처리","summary":"axios 사용시 timeout이 났을 때, 그리고 Client Network가 offline시 에러 처리","date":"2022.05.12.","categories":["WEB"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA20lEQVQoz61RSw6CMBDt/a9QNMYI6kKrhGAlIUYXaohuTACB+Ali4i3GdNAKCtqFi9fOvM73lYTjJvwTRBzBqCGJKrvIVflFntQ91iUU7XeUJvQZhYBpJfhDinj6odnKkxn9MiHTIJ7okC45XDwXjrMRpCsH0tVU3oI7zU247dbInRcWZJ4L2WaGOdftHA7uAJvjynurDYnTR4jiMe8iJCf8iSH5mBsQ2XrOiZsbWAMnlCuX1qOI95WffPAhD31pqPIpueiaUhz5GfTQOJn2QKU5Uekq9InsjlLBO1RQeYl0LwbEAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/f1f9a3dd3541a67186fac6184ea7ca5f/9b7d7/axios-error-handle.png","srcSet":"/static/f1f9a3dd3541a67186fac6184ea7ca5f/5d231/axios-error-handle.png 192w,\n/static/f1f9a3dd3541a67186fac6184ea7ca5f/e1116/axios-error-handle.png 384w,\n/static/f1f9a3dd3541a67186fac6184ea7ca5f/9b7d7/axios-error-handle.png 768w","sizes":"(min-width: 768px) 768px, 100vw"},"sources":[{"srcSet":"/static/f1f9a3dd3541a67186fac6184ea7ca5f/a3a09/axios-error-handle.webp 192w,\n/static/f1f9a3dd3541a67186fac6184ea7ca5f/5358b/axios-error-handle.webp 384w,\n/static/f1f9a3dd3541a67186fac6184ea7ca5f/81e8e/axios-error-handle.webp 768w","type":"image/webp","sizes":"(min-width: 768px) 768px, 100vw"}]},"width":768,"height":402}},"publicURL":"/static/f1f9a3dd3541a67186fac6184ea7ca5f/axios-error-handle.png"}}}}]}},"pageContext":{"slug":"/axios-error-handle/"}},
    "staticQueryHashes": []}